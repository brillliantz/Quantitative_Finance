from __future__ import division
from scipy.spatial.distance import cdist
import numpy as np
cimport numpy as np
DTYPE = np.float
ctypedef np.float_t DTYPE_t
def my_kernel_weighted2(np.ndarray[DTYPE_t, ndim=2] x, np.ndarray[DTYPE_t, ndim=2] y, float gamma=0.1):
    cdef np.ndarray[DTYPE_t, ndim=1] myweight = np.array([ 0.00641685,  0.00239053,  0.00232121,  0.02527263,  0.0099988 ,
        0.01023249,  0.01534209,  0.01724345,  0.01612875,  0.01007044,
        0.01007257,  0.01007044,  0.01007044,  0.02166956,  0.03142087,
        0.01704036,  0.03107947,  0.0144929 ,  0.01019832,  0.01007113,
        0.01067235,  0.01007063,  0.01007044,  0.01038659,  0.01390331,
        0.02340776,  0.01864887,  0.02727464,  0.01007739,  0.01007044,
        0.01036836,  0.01009036,  0.01253885,  0.00852851,  0.00794499,
        0.00721277,  0.01342078,  0.01534739,  0.01357887,  0.01396061,
        0.01154235,  0.0134212 ,  0.01007044,  0.01045292,  0.01007143,
        0.01007044,  0.01012461,  0.01003296,  0.00908083,  0.0099963 ,
        0.01014112,  0.00994759,  0.01263546,  0.01537199,  0.01027559,
        0.0118347 ,  0.03502663,  0.03579221,  0.00481215,  0.00491792,
        0.00701465,  0.03113024,  0.03178414,  0.01646749,  0.03151295,
        0.0117895 ,  0.01369095,  0.01174843,  0.0122236 ,  0.01044613,
        0.01177251,  0.02233186,  0.01701637,  0.00443494,  0.0106909 ,
        0.00588776,  0.00819582,  0.00658216,  0.00832698,  0.00752738])
    cdef np.ndarray[DTYPE_t, ndim=2] dis
    dis = cdist(x, y, metric='wminkowski', w=myweight, p=1)
    np.tanh(dis, dis)
    dis *= -gamma
    dis += 1
    return dis
